<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <script
			  src="https://code.jquery.com/jquery-3.5.1.min.js"
			  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
			  crossorigin="anonymous"></script>
  <script src='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css' rel='stylesheet' />
  <style>
    body {
      margin:0px;
    }
    #map {
      width: 700px;
      height: 800px;
      position: absolute;
    }
    .side-bar {
      width: 100px;
      height: 800px;
      position: absolute;
      margin-left: 600px;
      z-index: 10000;
    }
    .loc-button {
      color: white;
      height: 100px;
      width: 100%;
      background-color: rgba(50,50,50,.5);
      text-align: center;
      vertical-align: middle;
    }
    .loc-button:hover {
      background-color: rgba(50,50,50,.9);
    }
    .loc-button p {
      display:inline;
      vertical-align: middle;
    }
  </style>
</head>
<body>
  <div id='map' style=''></div>
  <div class="side-bar">
    <button id="north-br" class="loc-button"><p>North Baton Rouge</p></button>
    <button id="ds" class="loc-button"><p>Denham Springs</p></button>
    <button id="sorrento" class="loc-button">Sorrento</button>
    <button id="baker" class="loc-button">Baker</button>
  </div>
  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiYWNveDQyIiwiYSI6ImNrZjVtd3ZiejBvYnkyeW9nZnB4MzVva3EifQ.COv27lSO4vobAVLLHNVkQg';
    var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/legiongis/ckg13im88155l19pdgv294lu0',
      center: [-90.901, 30.401],
      zoom: 7.5
    });

    var hoveredStateId = null;

    map.on('load', function() {

      var jsonUrl = "https://raw.githubusercontent.com/css-lsu/web-mapping/main/ifc-map/StudyAreas.geojson"

      var jsonUrl = "StudyAreas.geojson"
      map.addSource('study-areas', {
        type: "geojson",
        data: jsonUrl,
      })

      // acquire the geojson features for
      var studyAreasFeatures = null;
      $.getJSON(jsonUrl, function(data) {
        studyAreasFeatures = data['features'];
      });

      map.addLayer({
        'id': 'cities',
        "type": "fill",
        "source": "study-areas",
        "paint": {
          "fill-color": "#00ffff",
          "fill-outline-color": "#00ff00",
        }
      })

      map.addLayer({
        'id': 'cities-hover',
        "type": "fill",
        "source": "study-areas",
        "paint": {
          'fill-color': '#627BC1',
          'fill-opacity': [
            'case',
            ['boolean', ['feature-state', 'hover'], false],
            1,
            0.5
          ]
        }
      })

      var popup = new mapboxgl.Popup({
        closeButton: false,
        closeOnClick: false
      });


      map.on('mouseenter', 'cities-hover', function (e) {

        if (e.features.length > 0) {
          if (hoveredStateId) {
            map.setFeatureState(
                { source: 'study-areas', id: hoveredStateId },
                { hover: false }
              );
            }
            hoveredStateId = e.features[0].id;
            map.setFeatureState(
              { source: 'study-areas', id: hoveredStateId },
              { hover: true }
            );
          }

      });

      map.on('mouseleave', 'cities-hover', function () {
        if (hoveredStateId) {
          map.setFeatureState(
            { source: 'study-areas', id: hoveredStateId },
            { hover: false }
          );
        }
        hoveredStateId = null;
      });

      map.on('mouseenter', 'cities', function (e) {
        // Change the cursor style as a UI indicator.
        map.getCanvas().style.cursor = 'pointer';

        var lng = e.features[0].properties.lbl_x;
        var lat = e.features[0].properties.lbl_y;
        var description = e.features[0].properties.name;

        // Populate the popup and set its coordinates
        // based on the feature found.
        // console.log(coordinates)
        popup.setLngLat([lng, lat]).setHTML(description).addTo(map);

      });

      map.on('mouseleave', 'cities', function () {
        map.getCanvas().style.cursor = '';
        popup.remove();
      });

      map.on('click', 'cities', function (e) {

        var bounds = [
          e.features[0].properties.x1,
          e.features[0].properties.y1,
          e.features[0].properties.x2,
          e.features[0].properties.y2,
        ]

        map.fitBounds(bounds, {
          padding: 20
        });

      });

      function buttonZoom() {

        var lookup = {
          "north-br": "North Baton Rouge Study Area",
          "ds": "Denham Springs Study Area",
          "sorrento": "Sorrento Study Area",
          "baker": "Baker Study Area",
        }
        var name = lookup[this.id]

        studyAreasFeatures.forEach(function(feature) {
          if (feature.properties.name == name) {
            var bounds = [
              feature.properties.x1,
              feature.properties.y1,
              feature.properties.x2,
              feature.properties.y2,
            ]

            map.fitBounds(bounds, {
              padding: 20
            });
            return

          }
        })
      }
      $(".loc-button").click(buttonZoom)

    });

  </script>
</body>
</html>
